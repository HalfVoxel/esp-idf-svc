<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="\brief           Import a key into the PSA key store."><title>mbedtls_pk_import_into_psa in esp_idf_svc::hal::sys - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-dd39b87e5fcfba68.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="esp_idf_svc" data-themes="" data-resource-suffix="" data-rustdoc-version="1.81.0-nightly (35b658fb1 2024-07-08)" data-channel="nightly" data-search-js="search-d234aafac6c221dd.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../esp_idf_svc/index.html">esp_idf_svc</a><span class="version">0.49.1</span></h2></div><div class="sidebar-elems"><h2><a href="index.html">In esp_idf_svc::hal::sys</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="../../index.html">esp_idf_svc</a>::<wbr><a href="../index.html">hal</a>::<wbr><a href="index.html">sys</a>::<wbr><a class="fn" href="#">mbedtls_pk_import_into_psa</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../../src/esp_idf_sys/home/runner/work/esp-idf-svc/esp-idf-svc/target/riscv32imc-esp-espidf/debug/build/esp-idf-sys-287a1e06334cf895/out/bindings.rs.html#38502-38506">source</a> Â· <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub unsafe extern &quot;C&quot; fn mbedtls_pk_import_into_psa(
    pk: *const <a class="struct" href="../../sys/struct.mbedtls_pk_context.html" title="struct esp_idf_svc::sys::mbedtls_pk_context">mbedtls_pk_context</a>,
    attributes: *const <a class="struct" href="../../sys/struct.psa_key_attributes_s.html" title="struct esp_idf_svc::sys::psa_key_attributes_s">psa_key_attributes_s</a>,
    key_id: *mut u32,
) -&gt; i32</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>\brief           Import a key into the PSA key store.</p>
<p>This function is equivalent to calling psa_import_key()
with the key material from \p pk.</p>
<p>The typical way to use this function is:
-# Call mbedtls_pk_get_psa_attributes() to obtain
attributes for the given key.
-# If desired, modify the attributes, for example:
- To create a persistent key, call
psa_set_key_identifier() and optionally
psa_set_key_lifetime().
- To import only the public part of a key pair:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code>      psa_set_key_type(<span class="kw-2">&amp;</span>attributes,
                       PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR(
                           psa_get_key_type(<span class="kw-2">&amp;</span>attributes)));
- Restrict the key usage <span class="kw">if </span>desired.</code></pre></div>
<p>-# Call mbedtls_pk_import_into_psa().</p>
<p>\note            This function does not support RSA-alt contexts
(set up with mbedtls_pk_setup_rsa_alt()).</p>
<p>\param[in] pk    The PK context to use. It must have been set up.
It can either contain a key pair or just a public key.
\param[in] attributes
The attributes to use for the new key. They must be
compatible with \p pk. In particular, the key type
must match the content of \p pk.
If \p pk contains a key pair, the key type in
attributes can be either the key pair type or the
corresponding public key type (to import only the
public part).
\param[out] key_id
On success, the identifier of the newly created key.
On error, this is #MBEDTLS_SVC_KEY_ID_INIT.</p>
<p>\return          0 on success.
#MBEDTLS_ERR_PK_TYPE_MISMATCH if \p pk does not contain
a key of the type identified in \p attributes.
Another error code on other failures.</p>
</div></details></section></div></main></body></html>